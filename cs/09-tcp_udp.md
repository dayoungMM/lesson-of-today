# TCP/UDP

## 개요

네트워크 계층 4 level  전송계층에서 데이터를 보내기 위해 사용하는 프로토콜

## TCP(Transmission Control Protocol)

### 특징

- 연결형 서비스로 연결이 성공해야 통신이 가능하다
- 3-way handshaking 과정을 통해 연결을 설정하고 4-way handshaking을 통해 해제


- 데이터의 경계를 구분하지 않는다 (바이트 스트림 서비스)
- 데이터의 전송 순서를 보장한다(데이터 순서 유지를 위해 각 바이트마다 번호 부여)
- 신뢰성 있는 데이터를 전송한다
- 데이터의 흐름 제어(수신자 버퍼 오버플로우 방지) 및 혼잡제어 (패킷 수가 과도하게 증가하는 현상 방지
- 전이중(Full-Duplex), 점대점(Point to Point)서비스
- UDP보다 속도가 느림

### 단점

- 데이터로 보내기 전에 반드시 연결이 형성되어야함
- 1:1 통신만 가능
- 고정된 통신 선로가 최단선이 아닐 경우 상대적으로 UDP보다 데이터 전송 속도 느림
    - TCP는 신뢰성 있는 연결을 위해 전송되는 데이터 패킷들의 순서, 패킷 유실 여부등을 검사하는데, 이로 인해 레이턴시가 발생할 수 있다.
- HOLB(Head of line Blocking)
    - TCP를 사용한 통신에서 패킷은 무조건 정확한 순서대로 처리되어야 한다
    - 즉, 수신측이 제대로 패킷을 받지 못했으면 송신 측에서 다시 보내야하며, 이 것이 파싱되기 전까지는 다음 패킷을 처리할 수 없다
    - 이로 인해 통신의 병목이 발생할 수 있다.

## UDP(User Datagram Protocol)

### 특징

- 비연결형 서비스로 연결 없이 통신이 가능하며 데이터 그램 방식을 사용
    - 연결 절차를 거치지 않고 발신자가 일방적으로 데이터 발신
- 데이터의 경계를 구분 (데이터 그램 서비스)
- 정보를 주고 받을 때 정보를 보내거나 받는다는 신호절차를 거치지 않음
- 신뢰성 없는 데이터 전송(데이터 재전송, 데이터 순서유지 하지 않음)
- 패킷 관리 필요
- 패킷 오버헤드가 적어 네트워크 부하가 감소되는 장점
- 상대적으로 TCP보다 빠르다

### 단점

- 데이터의 신뢰성이 없음
- 의미있는 서버를 구축하기 위해 일일이 패킷을 관리해주어야 함


> 💡 패킷: 인터넷 내에서 데이터를 보내기 위한 라우팅을 효율적으로 하기 위해 데이터를 여러개의 조각들로 나누어 전송하는데, 이 조각을 패킷이라고 함



- TCP vs UDP


    | 종류 | TCP | UDP |
    | --- | --- | --- |
    | 연결방식 | 연결형 서비스 | 비연결형 서비스 |
    | 패킷교환 | 가상 회선 방식 | 데이터 그램 방식 |
    | 전송 순서 | 전송 순서 보장 | 보장함 |
    | 힌뢰성 | 신뢰성 | 높음 |
    | 속도 | 전송 속도 | 느림 |

## [참고] RUDP (Reliable UDP)

- 개념
    - TCP의 장점인 신뢰성과 UDP의 장점인 속도를 모두 갖춘 Reliable UDP
    - Relay Server와 연동 - UDP 통신이 실패했을 때 데이터 전송
- 어떻게 신뢰성을 확보했을까?
    - 순서 보장 - 패킷에 번호를 붙이고 번호 순서대로 패킷이 도착할 때까지 기다렸다가 패킷이 모이면 그때 패킷을 풂
    - 패킷에 번호를 붙이고 해당 번호의 패킷이 도착할 때까지 재전송 하여 도착을 보장
    - UDP 송수신 중에는 연결 유지를 위해 일정 시간 간격으로 HeartBeat 패킷을 보내고, 일정시간동안 해당 패킷이 도착하지 않는다면 실패로 간주하고 릴레이 서버를 이용하여 지금껏 전송이 안된 패킷들을 전달
- 유의할 점
    - UDP로 연결을 시도하는 중에도 릴레이 서버를 통한 패킷 전달은 지속적으로 이루어져야 한다
    - UDP 연결이 성공했을 때 UDP를 통한 송신을 시작해야 한다
- 참고자료

  [https://mangkyu.tistory.com/15](https://mangkyu.tistory.com/15)

  [https://coding-factory.tistory.com/614](https://coding-factory.tistory.com/614)

  [https://elky.tistory.com/258](https://elky.tistory.com/258)