# 스프링 필터 vs 인터셉터

## 필터

- Dispatcher Servlet에 요청이 전달되기 전,후에 url 패턴에 맞는 모든 요청에 대해 부가적인 작업을 처리할 수 있는 기능
- Dispatcher Servlet은 스프링의 가장 앞단에 존재하는 프론트 컨트롤러이므로 Filter는 스프링 범위 밖에서 처리가됨
- 즉, 스프링 컨테이너가 아니라 톰캣과 같은 WAS에 의해 관리가 되는 것.

- 메소드
    - init
        - 필터 객체를 초기화 하고 서비스에 추가
    - doFilter
        - url-pattern에 맞는 모든 HTTP 요청에 대한 처리를 실행함
        - doFilter의 파라미터로 FilterChain이 있는데, FilterChain의 doFilter를 통해 다음 대상으로 요청을 전달하게 됨
    - destroy 메소드
        - 필터 객체를 서비스에서 제거하고 사용하는 자원을 반환함.
        - 실행 후에는 이제 doFilter에 의해 처리되지 않음


## 인터셉터

- Spring이 제공하는 기술
- Dispatcher Servlet이 컨트롤러를 호출하기 전과 후에 요청과 응답을 참조하거나 가공할 수 있는 기능 제공
- 스프링 컨텍스트 안에서 동작
- 메소드
    - preHandle : 컨트롤러 호출 전
    - postHandle: 컨트롤러 호출 후
    - afterCompletion:  모든 뷰에서 최종 결과를 생성하는 일을 포함해 모든 작업이 완료된 후




## 비교

| 대상 | Filter | Interceptor |
| --- | --- | --- |
| 관리되는 컨테이너 | 웹 컨테이너 | 스프링 컨테이너 |
| Req/Res 객체 조작 가능 여부 | O | X |
| 용도 | • 공통된 보안 및 인증/인가 관련 작업
• 모든 요청에 대한 로깅 또는 감사
• 이미지/데이터 압축 및 문자열 인코딩
• Spring 과 분리되어야 하는 기능 | • 세부적인 보안 및 인증/인가 공통 작업
• API 호출에 대한 로깅 또는 감사
• Controller로 넘겨주는 정보의 가공 |

## Interceptor vs AOP

- 인터셉터 대신에 컨트롤러에 적용할 부가기능을 AOP로 만들어보면 어떨까? 생각해볼 수 있다
- 하지만 컨트롤러 호출 과정에서 필요한 부가기능은 Interceptor로 구현하는게 낫다
    - 컨트롤러는 타입과 실행 메서드가 모두 제각각이라 AOP의 포인트컷 작성이 어렵기 때문
    - 컨트롤러는 파라미터나 리턴 값이 일정하지 않기 때문에 AOP로 작성하기 까다롭기 때문